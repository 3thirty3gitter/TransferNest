---
id: PM-20240904-1001-build-error
created_at: 2024-09-04T10:01:00Z
updated_at: 2024-09-04T10:01:00Z
projects: [TransferNest]
systems: [genkit-api, build-process]
tags: [genkit, nextjs]
severity: critical
status: resolved
checkpoint: f124263
provenance:
  origin_paths: [docs/support-library/printpilot-support-library.md]
  commits: []
  imported_from: "Internal project documentation"
  hash: 978939c06368d71d3a77839352e85a6a61c77395563919e159670d8a87b1c1b1
superseded_by: null
---

## Post-Mortem: Persistent Build Error in Genkit API Route

- **ID:** PM-20240904-1001-build-error
- **Date:** 2024-09-04T10:01:00Z
- **Scope:** `src/app/api/genkit/[[...slug]]/route.ts`.
- **Symptoms:** After attempting to fix the SDK conflict, a new, persistent build error emerged: `Build Error: Export GET doesn't exist in target module @genkit-ai/next`.
- **Timeline:**
  - `T0`: First attempt to create the Genkit API route resulted in this build error.
  - `T1-T4`: Multiple subsequent fix attempts failed with the same error, indicating a flawed diagnosis or correction.
- **Root Cause:** The `@genkit-ai/next` plugin does not provide named exports for `GET` and `POST`. Instead, it augments the `ai` instance with which it is configured. The correct syntax is to export the handlers *from the configured `ai` instance itself*. The incorrect syntax `export { GET, POST } from '@genkit-ai/next';` was repeatedly used.
- **Evidence:** The Next.js build output explicitly stated the named export could not be found. The Genkit documentation specifies the correct usage pattern.
- **Fix:** The incorrect export statement in `src/app/api/genkit/[[...slug]]/route.ts` was replaced with the correct one: `export const { GET, POST } = ai;`.
- **Validation:** The application builds successfully. The Genkit API routes for flows are correctly exposed and accessible via `fetch`.
- **Blast Radius:** Development was completely blocked. No production impact.
- **Regression Risk:** Low. The correct syntax is now documented in this library.
- **Lessons Learned:**
  - Always consult the documentation for specific library APIs, especially for plugins or framework integrations. Do not assume standard ES module export patterns.
  - When a build error is explicit and persistent, re-read the relevant documentation instead of re-applying the same failed fix.
- **Preventive Controls:**
  - Create a "cookbook" or example file for common integration patterns like setting up Genkit API routes.
- **Rollback Plan:** Revert `src/app/api/genkit/[[...slug]]/route.ts` to use the incorrect `export { GET, POST } from '@genkit-ai/next';` syntax. This will cause the build to fail again.
- **Owners:** N/A
- **Related Incidents:** This was a consequence of fixing PM-20240904-1000-sdk-conflict.
